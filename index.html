<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Para Norelen</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        /* --- VARIABLES DE TEMA (NUEVO TEMA VERDE/AZUL POR DEFECTO) --- */
        :root {
            --bg-color: #111827;
            --text-color: #e0e0e0;
            --primary-glow-1: rgba(20, 184, 166, 0.7);
            --primary-glow-2: rgba(13, 148, 136, 0.5);
            --card-bg-1: #1F2937;
            --card-bg-2: #111827;
            --card-border-1: #22d3ee;
            --card-border-2: #34d399;
            --card-border-3: #67e8f9;
            --card-border-4: #0d9488;
            --cursor-glow-color: rgba(34, 211, 238, 0.3);
            --particle-rgb: 20, 184, 166; /* Verde azulado */
            --constellation-rgb: 52, 211, 153; /* Esmeralda */
            --scrollbar-thumb-1: #22d3ee;
            --scrollbar-thumb-2: #34d399;
            --scrollbar-thumb-3: #0d9488;
            --input-wrapper-error: #ef4444;
            --input-wrapper-success: #10b981;
        }

        /* Tema desbloqueable "Love" */
        body.theme-love {
            --primary-glow-1: rgba(252, 131, 202, 0.7);
            --primary-glow-2: rgba(244, 63, 155, 0.5);
            --card-bg-1: #2e1a24;
            --card-bg-2: #2e1a23;
            --card-border-1: #f43f9b;
            --card-border-2: #d946ef;
            --card-border-3: #ec4899;
            --card-border-4: #ef4444;
            --cursor-glow-color: rgba(236, 72, 153, 0.3);
            --particle-rgb: 167, 139, 250; /* Morado */
            --constellation-rgb: 251, 146, 185; /* Rosa claro */
            --scrollbar-thumb-1: #f472b6;
            --scrollbar-thumb-2: #ec4899;
            --scrollbar-thumb-3: #e879f9;
            --input-wrapper-success: #ec4899;
        }

        /* Estilos generales */
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            overflow-x: hidden;
            min-height: 100vh;
            transition: background-color 0.5s ease;
        }

        #particle-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }

        main {
            position: relative;
            z-index: 1;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem 1rem;
        }

        .text-glow {
            text-shadow: 0 0 8px var(--primary-glow-1), 0 0 20px var(--primary-glow-2);
            transition: text-shadow 0.5s ease;
        }

        @property --angle {
          syntax: '<angle>';
          initial-value: 0deg;
          inherits: false;
        }

        .glowing-card {
            --border-size: 3px;
            --angle: 0deg;
            border: var(--border-size) solid transparent;
            border-radius: 1.5rem;
            background-image: 
                linear-gradient(to right, var(--card-bg-1), var(--card-bg-2)),
                conic-gradient(from var(--angle), var(--card-border-1), var(--card-border-2), var(--card-border-3), var(--card-border-4));
            background-size: 100% 100%;
            background-position: center center;
            background-clip: padding-box, border-box;
            background-origin: padding-box, border-box;
            animation: rotate-angle 4s linear infinite;
            transition: padding 0.7s cubic-bezier(0.45, 0, 0.55, 1), background-image 0.5s ease;
            position: relative;
            width: 100%;
            max-width: 4xl;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .glowing-card.is-shrunken {
            padding-top: 2rem;
            padding-bottom: 2rem;
        }
        
        #intro-paragraph {
            transition: max-height 0.7s cubic-bezier(0.45, 0, 0.55, 1), margin 0.7s cubic-bezier(0.45, 0, 0.55, 1), opacity 0.5s ease-out;
            max-height: 200px;
            overflow: hidden;
        }

        .action-button {
            transition: width 0.5s ease, padding 0.5s ease, opacity 0.5s ease, margin 0.5s ease;
            overflow: hidden;
            white-space: nowrap;
        }
        
        #button-container, #love-button-container {
            transition: max-height 0.5s ease, opacity 0.3s ease, margin 0.5s ease;
        }

        #back-button {
            transition: opacity 0.5s ease 0.2s, transform 0.5s ease 0.2s;
        }

        .message, #secret-code-section, #writings-section {
            transition: opacity 0.4s ease, max-height 0.5s ease;
            max-height: 0;
            overflow: hidden;
            opacity: 0;
        }
        .message.is-visible, #secret-code-section.is-visible, #writings-section.is-visible {
            max-height: 500px; /* Reducido para que quepa mejor */
            opacity: 1;
        }
        
        @keyframes rotate-angle {
            to { --angle: 360deg; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
        }
        
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
        
        #cursor-glow {
            position: fixed;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--cursor-glow-color);
            filter: blur(20px);
            pointer-events: none;
            transform: translate(-50%, -50%);
            transition: transform 0.1s ease-out, background 0.5s ease;
            z-index: 9999;
        }

        .gradient-ball {
            background: conic-gradient(from var(--angle), var(--card-border-1), var(--card-border-3), var(--card-border-2));
            animation: rotate-angle 4s linear infinite;
        }

        #secret-input-wrapper {
            position: relative;
            border-radius: 0.75rem;
            padding: 2px;
            background: rgba(255, 255, 255, 0.2);
            transition: background 0.4s;
        }
        #secret-input-wrapper.is-focused {
            background: conic-gradient(from var(--angle), var(--card-border-1), var(--card-border-2), var(--card-border-3), var(--card-border-4));
            animation: rotate-angle 4s linear infinite;
        }
        #secret-input-wrapper.success {
            background: var(--input-wrapper-success);
            animation: none;
        }
        #secret-input-wrapper.error {
            background: var(--input-wrapper-error);
            animation: shake 0.82s cubic-bezier(.36,.07,.19,.97) both;
        }

        #secret-code-input {
            background-color: var(--bg-color);
            border: none;
            outline: none;
            width: 100%;
            border-radius: 0.6rem;
        }

        #writing-display {
            transition: opacity 0.5s ease;
            max-height: 250px; 
            overflow-y: auto;
            padding-right: 1rem; 
        }

        #writing-display::-webkit-scrollbar { width: 8px; }
        #writing-display::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.1); border-radius: 10px; }
        #writing-display::-webkit-scrollbar-thumb { background: linear-gradient(45deg, var(--scrollbar-thumb-1), var(--scrollbar-thumb-2), var(--scrollbar-thumb-3)); border-radius: 10px; }
        #writing-display::-webkit-scrollbar-thumb:hover { filter: brightness(1.2); }

        /* Scroll personalizado para la tarjeta principal */
        .glowing-card::-webkit-scrollbar { width: 8px; }
        .glowing-card::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.1); border-radius: 10px; }
        .glowing-card::-webkit-scrollbar-thumb { background: linear-gradient(45deg, var(--scrollbar-thumb-1), var(--scrollbar-thumb-2), var(--scrollbar-thumb-3)); border-radius: 10px; }
        .glowing-card::-webkit-scrollbar-thumb:hover { filter: brightness(1.2); }

        /* --- NUEVOS ESTILOS PARA FUNCIONES DESBLOQUEABLES --- */
        .heart {
            position: fixed;
            top: -10vh;
            font-size: 2rem;
            transform: translateY(0);
            animation: fall 5s linear forwards;
            pointer-events: none;
            z-index: 10000;
        }

        @keyframes fall {
            to {
                transform: translateY(110vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* Media queries para ajustar en m√≥viles */
        @media (max-height: 700px) {
            .glowing-card {
                max-height: 95vh;
            }
            
            h1 {
                font-size: 3rem !important;
            }
            
            #intro-paragraph {
                font-size: 1rem !important;
                margin-bottom: 1.5rem !important;
            }
            
            .action-button {
                padding: 0.6rem 1.5rem !important;
                font-size: 0.9rem !important;
            }
        }

        @media (max-height: 600px) {
            main {
                padding: 1rem;
            }
            
            .glowing-card {
                padding: 1.5rem !important;
                max-height: 98vh;
            }
            
            .glowing-card.is-shrunken {
                padding: 1rem !important;
            }
        }
    </style>
</head>
<body class="min-h-screen">

    <canvas id="particle-canvas"></canvas>
    <div id="cursor-glow"></div>

    <main class="text-center w-full max-w-4xl mx-auto">
        
        <div id="glowing-card" class="glowing-card p-6 sm:p-8 md:p-10">
            
            <a href="#" id="back-button" class="gradient-ball absolute top-4 left-4 w-10 h-10 rounded-full flex items-center justify-center opacity-0 pointer-events-none transform hover:scale-110 -translate-x-20">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="white" viewBox="0 0 256 256" class="relative z-10"><path d="M168.49,199.51a12,12,0,0,1-17,17l-80-80a12,12,0,0,1,0-17l80-80a12,12,0,0,1,17,17L97,128Z"></path></svg>
            </a>

            <div class="animate-float">
                <h1 class="text-4xl md:text-6xl font-bold text-white text-glow mb-3">
                    Norelen
                </h1>
            </div>

            <p id="intro-paragraph" class="text-base md:text-lg text-gray-300 max-w-2xl mx-auto mt-4 mb-6">
                Un espacio creado solo para ti. Exclusivamente para ti. Espero que te guste ;)
            </p>

            <div id="button-container" class="flex flex-col sm:flex-row items-center justify-center gap-3">
                <a href="#" id="gallery-button" class="action-button w-full sm:w-auto bg-pink-500/80 hover:bg-pink-500 text-white font-semibold py-2.5 px-6 rounded-full shadow-lg shadow-pink-500/30 hover:shadow-pink-500/50 transform hover:scale-105">
                    Tu Galer√≠a
                </a>
                <a href="#" id="writings-button" class="action-button w-full sm:w-auto bg-cyan-500/80 hover:bg-cyan-500 text-white font-semibold py-2.5 px-6 rounded-full shadow-lg shadow-cyan-500/30 hover:shadow-cyan-500/50 transform hover:scale-105">
                    Escritos
                </a>
                <a href="#" id="phrase-button" class="action-button w-full sm:w-auto bg-purple-500/80 hover:bg-purple-500 text-white font-semibold py-2.5 px-6 rounded-full shadow-lg shadow-purple-500/30 hover:shadow-purple-500/50 transform hover:scale-105">
                    &lt;3
                </a>
                <a href="#" id="lock-button" class="action-button w-full sm:w-auto bg-gray-600/80 hover:bg-gray-500 text-white font-semibold p-2.5 rounded-full shadow-lg shadow-gray-500/30 hover:shadow-gray-500/50 transform hover:scale-105">
                    üîê
                </a>
            </div>

            <!-- NUEVO CONTENEDOR PARA EL BOT√ìN DE AMOR -->
            <div id="love-button-container" class="mt-4 text-center h-12"> <!-- Altura reducida -->
                <a href="#" id="love-button" class="hidden inline-block bg-pink-500/80 hover:bg-pink-500 text-white font-bold py-3 px-8 rounded-full shadow-lg shadow-pink-500/30 hover:shadow-pink-500/50 transform hover:scale-110 transition-all duration-500 opacity-0 scale-90">
                    TE AMOOOüíóüíñ
                </a>
            </div>
            
            <p id="special-phrase" class="message text-pink-300 text-lg mt-6"></p>
            <p id="gallery-message" class="message text-cyan-300 text-base mt-6 leading-relaxed"></p>

            <div id="memory-section" class="message flex flex-col items-center justify-center text-center mt-6">
                <h3 class="text-xl font-bold text-pink-300 mb-3">Un Recuerdo Especial ‚ú®</h3>
                <div class="bg-black/20 p-2 rounded-xl shadow-lg transform hover:scale-105 transition-transform duration-500">
                    <img id="memory-image" src="https://placehold.co/350x250/1a1a2e/e0e0e0?text=Nuestro+Recuerdo" alt="Un recuerdo especial" class="rounded-lg">
                </div>
                <p id="memory-caption" class="mt-3 text-gray-300 italic text-sm">Aqu√≠ ir√° una foto y descripci√≥n que agregar√°s t√∫ ;)</p>
            </div>
            
            <div id="writings-section" class="w-full text-left mt-6">
                <div id="writings-buttons" class="flex flex-col items-center gap-3 w-full"></div>
                <div id="writing-display" class="hidden opacity-0">
                    <h3 id="writing-title" class="text-xl font-bold text-pink-300 mb-3 text-center"></h3>
                    <p id="writing-content" class="text-gray-300 leading-relaxed whitespace-pre-wrap text-sm"></p>
                </div>
            </div>

            <div id="secret-code-section" class="mt-4">
                <div class="flex items-center justify-center gap-2">
                    <div id="secret-input-wrapper" class="w-full max-w-xs mx-auto">
                        <input type="text" id="secret-code-input" placeholder="Introduce un c√≥digo" class="text-center w-full p-2 rounded-lg text-white">
                    </div>
                    <a href="#" id="submit-code-button" class="gradient-ball w-10 h-10 rounded-full flex-shrink-0 flex items-center justify-center transform hover:scale-110">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="white" viewBox="0 0 256 256"><path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm45.66,85.66-48,48a8,8,0,0,1-11.32,0l-24-24a8,8,0,0,1,11.32-11.32L112,140.69l42.34-42.35a8,8,0,0,1,11.32,11.32Z"></path></svg>
                    </a>
                </div>
            </div>

        </div>

    </main>

    <script>
        // Efecto de brillo del cursor
        const cursorGlow = document.getElementById('cursor-glow');
        document.addEventListener('mousemove', (e) => {
            requestAnimationFrame(() => {
                cursorGlow.style.left = `${e.clientX}px`;
                cursorGlow.style.top = `${e.clientY}px`;
            });
        });

        // Efecto de part√≠culas y constelaciones
        const canvas = document.getElementById('particle-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let particlesArray;
        
        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.size = Math.random() * 2.5 + 1;
                this.speedX = (Math.random() * 0.6) - 0.3;
                this.speedY = (Math.random() * 0.6) - 0.3;
                this.updateColor();
            }
            updateColor() {
                this.color = `rgba(${getComputedStyle(document.body).getPropertyValue('--particle-rgb')}, 0.6)`;
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                if (this.x < 0 || this.x > canvas.width) this.speedX *= -1;
                if (this.y < 0 || this.y > canvas.height) this.speedY *= -1;
            }
            draw() {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        function init() {
            particlesArray = [];
            let numberOfParticles = (canvas.height * canvas.width) / 12000;
            for (let i = 0; i < numberOfParticles; i++) {
                particlesArray.push(new Particle());
            }
        }
        function connect() {
            let opacityValue = 1;
            const constellationRGB = getComputedStyle(document.body).getPropertyValue('--constellation-rgb');
            for (let a = 0; a < particlesArray.length; a++) {
                for (let b = a; b < particlesArray.length; b++) {
                    let distance = ((particlesArray[a].x - particlesArray[b].x) ** 2) + ((particlesArray[a].y - particlesArray[b].y) ** 2);
                    if (distance < (canvas.width/7) * (canvas.height/7)) {
                        opacityValue = 1 - (distance/20000);
                        ctx.strokeStyle = `rgba(${constellationRGB}, ${opacityValue})`;
                        ctx.lineWidth = 1;
                        ctx.beginPath();
                        ctx.moveTo(particlesArray[a].x, particlesArray[a].y);
                        ctx.lineTo(particlesArray[b].x, particlesArray[b].y);
                        ctx.stroke();
                    }
                }
            }
        }
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let i = 0; i < particlesArray.length; i++) {
                particlesArray[i].update();
                particlesArray[i].draw();
            }
            connect();
            requestAnimationFrame(animate);
        }
        init();
        animate();
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            init();
        });

        // --- L√ìGICA DE LA INTERFAZ ---

        const glowingCard = document.getElementById('glowing-card');
        const phraseButton = document.getElementById('phrase-button');
        const galleryButton = document.getElementById('gallery-button');
        const writingsButton = document.getElementById('writings-button');
        const lockButton = document.getElementById('lock-button');
        const backButton = document.getElementById('back-button');
        const phraseElement = document.getElementById('special-phrase');
        const galleryMessage = document.getElementById('gallery-message');
        const memorySection = document.getElementById('memory-section');
        const secretCodeSection = document.getElementById('secret-code-section');
        const secretInputWrapper = document.getElementById('secret-input-wrapper');
        const secretCodeInput = document.getElementById('secret-code-input');
        const submitCodeButton = document.getElementById('submit-code-button');
        const buttonContainer = document.getElementById('button-container');
        const loveButton = document.getElementById('love-button');
        const loveButtonContainer = document.getElementById('love-button-container');
        const introParagraph = document.getElementById('intro-paragraph');
        const writingsSection = document.getElementById('writings-section');
        const writingsButtons = document.getElementById('writings-buttons');
        const writingDisplay = document.getElementById('writing-display');
        const writingTitle = document.getElementById('writing-title');
        const writingContent = document.getElementById('writing-content');

        // Contenido y Datos
        const phrases = [ "Eres demasiado bonita...", "No importa lo que pase...", "Tu luz ilumina...", "Eres un sue√±o...", "Tu existencia es la poes√≠a...", "No importa cu√°ntas veces...", "Cada parte de ti es bella...", "Eres la raz√≥n por la que creo...", "Necesito que lo recuerdes...", "99.9% de probabilidad...", "Eres la definici√≥n de belleza...", "Formas parte de mis pensamientos...", "Si me preguntaras cu√°ntas veces...", "Bonita es la palabra...", "Si la belleza fuera tiempo...", "Sisisi, eres pro, lo acepto." ];
        const writingsData = {
            'carta-1': { title: "Para la chica de mis sue√±os", content: `T√∫, Amy Norelen...`, locked: true },
            'carta-2': { title: "Sinceridad", content: `Oye‚Ä¶ no s√© c√≥mo empezar esto...`, locked: false }
        };

        let currentPhraseIndex = -1;
        let animationState = 'initial';
        let unlockedFeatures = { gallery: false };

        function triggerHeartShower() {
            const heartEmojis = ['‚ù§Ô∏è', 'üíñ', 'üíï', 'üíó', 'üíì', 'üíû'];
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    const heart = document.createElement('div');
                    heart.classList.add('heart');
                    heart.innerText = heartEmojis[Math.floor(Math.random() * heartEmojis.length)];
                    heart.style.left = `${Math.random() * 100}vw`;
                    heart.style.animationDuration = `${Math.random() * 2 + 3}s`;
                    heart.style.fontSize = `${Math.random() * 1.5 + 1}rem`;
                    document.body.appendChild(heart);
                    setTimeout(() => heart.remove(), 5000);
                }, i * 100);
            }
        }

        const secretCodes = {
            'apuesta': { type: 'writing', key: 'carta-1', message: 'Escrito desbloqueado.' },
            'teamo': { type: 'unlock_button', buttonId: 'love-button', message: '¬°Bot√≥n secreto desbloqueado!'},
            'recuerdo': { type: 'unlock', feature: 'gallery', message: 'Recuerdo especial desbloqueado. üñºÔ∏è' }
        };

        function showMessage(element, text) {
            document.querySelectorAll('.message').forEach(msg => msg.classList.remove('is-visible'));
            writingsSection.classList.remove('is-visible');
            setTimeout(() => {
                if (text) element.innerHTML = text;
                element.classList.add('is-visible');
            }, 300);
        }

        function shrinkCard() {
            if (animationState === 'initial') {
                glowingCard.classList.add('is-shrunken');
                introParagraph.style.maxHeight = '0';
                introParagraph.style.margin = '0';
                introParagraph.classList.add('opacity-0');
                backButton.classList.remove('opacity-0', 'pointer-events-none', '-translate-x-20');
            }
        }

        function handleSectionClick(state, element, text) {
            if (animationState !== 'initial') return;
            shrinkCard();
            animationState = state;
            buttonContainer.style.maxHeight = '0';
            buttonContainer.style.opacity = '0';
            buttonContainer.classList.add('pointer-events-none');
            
            // Oculta el contenedor del bot√≥n de amor tambi√©n para evitar que ocupe espacio
            if (loveButtonContainer) {
                loveButtonContainer.style.maxHeight = '0';
                loveButtonContainer.style.opacity = '0';
                loveButtonContainer.style.marginTop = '0';
                loveButtonContainer.classList.add('pointer-events-none');
            }

            if (element) {
                if(text) element.innerHTML = text;
                element.classList.add('is-visible');
            }
        }

        phraseButton.addEventListener('click', (e) => {
            e.preventDefault();
            if (animationState !== 'phrases') {
                shrinkCard();
                animationState = 'phrases';
                ['gallery-button', 'writings-button', 'lock-button'].forEach(id => {
                    const btn = document.getElementById(id);
                    btn.style.width = '0'; btn.style.padding = '0'; btn.style.margin = '0'; btn.style.opacity = '0';
                });
                buttonContainer.style.justifyContent = 'center';
            }
            let randomIndex;
            do { randomIndex = Math.floor(Math.random() * phrases.length); } while (phrases.length > 1 && randomIndex === currentPhraseIndex);
            currentPhraseIndex = randomIndex;
            showMessage(phraseElement, phrases[currentPhraseIndex]);
        });
        
        galleryButton.addEventListener('click', (e) => {
            e.preventDefault();
            handleSectionClick('gallery', unlockedFeatures.gallery ? memorySection : galleryMessage, unlockedFeatures.gallery ? null : "Uyyy, lo siento...üòâ");
        });
        
        lockButton.addEventListener('click', (e) => { e.preventDefault(); handleSectionClick('secret'); secretCodeSection.classList.add('is-visible'); });

        writingsButton.addEventListener('click', (e) => {
            e.preventDefault(); handleSectionClick('writings', writingsSection);
            writingsButtons.innerHTML = ''; let unlockedCount = 0;
            for (const key in writingsData) {
                if (!writingsData[key].locked) {
                    unlockedCount++; const button = document.createElement('a'); button.href = '#'; button.textContent = writingsData[key].title; button.dataset.key = key; button.className = 'w-full max-w-sm bg-purple-500/80 hover:bg-purple-500 text-white font-semibold py-3 px-6 rounded-full shadow-lg shadow-purple-500/30 transform hover:scale-105 transition-all'; writingsButtons.appendChild(button);
                }
            }
            if (unlockedCount === 0) { const p = document.createElement('p'); p.textContent = 'A√∫n no has desbloqueado ning√∫n escrito.'; p.className = 'text-center text-gray-400'; writingsButtons.appendChild(p); }
            writingDisplay.classList.add('hidden', 'opacity-0'); writingsButtons.classList.remove('hidden');
        });

        writingsButtons.addEventListener('click', (e) => {
            e.preventDefault();
            if (e.target.tagName === 'A') {
                const writing = writingsData[e.target.dataset.key];
                if (writing) {
                    writingTitle.textContent = writing.title; writingContent.textContent = writing.content;
                    writingsButtons.classList.add('hidden'); writingDisplay.classList.remove('hidden');
                    setTimeout(() => writingDisplay.classList.add('opacity-100'), 50);
                }
            }
        });

        secretCodeInput.addEventListener('focus', () => secretInputWrapper.classList.add('is-focused'));
        secretCodeInput.addEventListener('blur', () => secretInputWrapper.classList.remove('is-focused'));

        // --- L√ìGICA DE C√ìDIGOS ACTUALIZADA ---
        submitCodeButton.addEventListener('click', (e) => {
            e.preventDefault();
            secretInputWrapper.classList.remove('error', 'success', 'is-focused');
            const enteredCode = secretCodeInput.value.trim().toLowerCase();
            const codeData = secretCodes[enteredCode];

            if (codeData) {
                secretInputWrapper.classList.add('success');
                switch (codeData.type) {
                    case 'writing': writingsData[codeData.key].locked = false; break;
                    case 'unlock_button': document.getElementById(codeData.buttonId)?.classList.remove('hidden', 'opacity-0', 'scale-90'); break;
                    case 'unlock': 
                        unlockedFeatures[codeData.feature] = true;
                        if(codeData.feature === 'gallery') galleryButton.innerHTML = 'Nuestro Recuerdo ‚ú®';
                        break;
                }
                secretCodeInput.placeholder = codeData.message; secretCodeInput.value = '';
                setTimeout(() => {
                    backButton.click(); setTimeout(() => { secretCodeInput.placeholder = 'Introduce un c√≥digo'; }, 500);
                }, 1500);
            } else {
                secretInputWrapper.classList.add('error'); secretCodeInput.value = ''; secretCodeInput.placeholder = 'C√≥digo incorrecto.';
                setTimeout(() => { secretInputWrapper.classList.remove('error'); secretCodeInput.placeholder = 'Introduce un c√≥digo'; }, 1500);
            }
        });

        loveButton.addEventListener('click', (e) => {
            e.preventDefault();
            document.body.classList.add('theme-love');
            particlesArray.forEach(p => p.updateColor()); // Actualiza el color sin recrear
            triggerHeartShower();
        });

        backButton.addEventListener('click', (e) => {
            e.preventDefault();
            if (animationState === 'initial') return;
            if (animationState === 'writings' && !writingDisplay.classList.contains('hidden')) {
                writingDisplay.classList.remove('opacity-100');
                setTimeout(() => { writingDisplay.classList.add('hidden'); writingsButtons.classList.remove('hidden'); }, 400);
                return; 
            }
            glowingCard.classList.remove('is-shrunken');
            backButton.classList.add('opacity-0', 'pointer-events-none', '-translate-x-20');
            document.querySelectorAll('.message, #secret-code-section, #writings-section').forEach(el => el.classList.remove('is-visible'));
            secretCodeInput.value = ''; secretInputWrapper.classList.remove('error', 'success', 'is-focused');
            introParagraph.style.maxHeight = ''; introParagraph.style.margin = ''; introParagraph.classList.remove('opacity-0');
            buttonContainer.style.maxHeight = ''; buttonContainer.style.opacity = ''; buttonContainer.classList.remove('pointer-events-none'); buttonContainer.style.justifyContent = '';
            
            // Restaura el contenedor del bot√≥n de amor
            if (loveButtonContainer) {
                loveButtonContainer.style.maxHeight = '';
                loveButtonContainer.style.opacity = '';
                loveButtonContainer.style.marginTop = '';
                loveButtonContainer.classList.remove('pointer-events-none');
            }

            document.querySelectorAll('.action-button').forEach(btn => { btn.style.width = ''; btn.style.padding = ''; btn.style.margin = ''; btn.style.opacity = ''; });
            animationState = 'initial';
        });
    </script>

</body>
</html>
