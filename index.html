<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Para Norelen</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        /* Estilos personalizados para complementar Tailwind */
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #1a1a2e;
            color: #e0e0e0;
            overflow: hidden; /* Evita el scroll para mantener el efecto de fondo */
        }

        #particle-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }

        main {
            position: relative;
            z-index: 1;
        }

        .text-glow {
            text-shadow: 0 0 8px rgba(72, 236, 118, 0.6), 0 0 20px rgba(36, 156, 62, 0.4);
        }

        @property --angle {
          syntax: '<angle>';
          initial-value: 0deg;
          inherits: false;
        }

        .glowing-card {
            --border-size: 3px;
            --angle: 0deg;
            
            border: var(--border-size) solid transparent;
            border-radius: 1.5rem;
            
            background-image: 
                linear-gradient(to right, #1a2e24, #1a232e),
                conic-gradient(from var(--angle), #46ef5a, #57bb7e, #a6ff8a, #28aa59);
            
            background-size: 100% 100%;
            background-position: center center;
            background-clip: padding-box, border-box;
            background-origin: padding-box, border-box;
            
            animation: rotate-angle 4s linear infinite;
            transition: padding 0.7s cubic-bezier(0.45, 0, 0.55, 1);
            position: relative; /* Necesario para posicionar el bot√≥n de regreso */
        }
        
        .glowing-card.is-shrunken {
            padding-top: 3rem;
            padding-bottom: 3rem;
        }
        
        #intro-paragraph {
            transition: max-height 0.7s cubic-bezier(0.45, 0, 0.55, 1), margin 0.7s cubic-bezier(0.45, 0, 0.55, 1), opacity 0.5s ease-out;
            max-height: 200px;
            overflow: hidden;
        }

        .action-button {
            transition: width 0.5s ease, padding 0.5s ease, opacity 0.5s ease, margin 0.5s ease;
            overflow: hidden;
            white-space: nowrap;
        }
        
        #button-container {
            transition: max-height 0.5s ease, opacity 0.3s ease;
        }

        #back-button {
            transition: opacity 0.5s ease 0.2s, transform 0.5s ease 0.2s;
        }

        .message, #secret-code-section, #writings-section {
            transition: opacity 0.4s ease, max-height 0.5s ease;
            max-height: 0;
            overflow: hidden;
            opacity: 0;
        }
        .message.is-visible, #secret-code-section.is-visible, #writings-section.is-visible {
            max-height: 500px; /* Aumentado para dar espacio a los textos */
            opacity: 1;
        }
        
        @keyframes rotate-angle {
            to { --angle: 360deg; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
        
        #cursor-glow {
            position: fixed;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(72, 236, 88, 0.3);
            filter: blur(20px);
            pointer-events: none;
            transform: translate(-50%, -50%);
            transition: transform 0.1s ease-out;
            z-index: 9999;
        }

        .gradient-ball {
            background: conic-gradient(from var(--angle), #4ae657, #2b97a7, #5cf6b3, #76d855);
            animation: rotate-angle 4s linear infinite;
        }

        #secret-input-wrapper {
            position: relative;
            border-radius: 0.75rem;
            padding: 2px; /* Grosor del borde */
            background: rgba(255, 255, 255, 0.2); /* Borde "apagado" */
            transition: background 0.4s;
        }
        #secret-input-wrapper.is-focused {
            background: conic-gradient(from var(--angle), #7cef46, #48ec9f, #5ce9f6, #46ef9a);
            animation: rotate-angle 4s linear infinite;
        }
        #secret-input-wrapper.success {
            background: #22c55e;
            animation: none; /* Detener animaci√≥n en √©xito */
        }
        #secret-input-wrapper.error {
            background: #ef4444; /* Borde rojo en error */
            animation: shake 0.82s cubic-bezier(.36,.07,.19,.97) both;
        }

        #secret-code-input {
            background-color: #1a1a2e; /* Color de fondo interior */
            border: none;
            outline: none;
            width: 100%;
            border-radius: 0.6rem; /* Radio interior */
        }

        #writing-display {
            transition: opacity 0.5s ease;
            max-height: 300px; 
            overflow-y: auto;
            padding-right: 1rem; 
        }

        #writing-display::-webkit-scrollbar {
            width: 8px;
        }

        #writing-display::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        #writing-display::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #7cef46, #6bec48, #69f65c);
            border-radius: 10px;
        }

        #writing-display::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(45deg, #57ff76, #5bff5e, #6effd6);
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <canvas id="particle-canvas"></canvas>
    <div id="cursor-glow"></div>

    <main class="text-center w-full max-w-4xl mx-auto">
        
        <div id="glowing-card" class="glowing-card p-8 sm:p-12 md:p-16">
            
            <a href="#" id="back-button" class="gradient-ball absolute top-6 left-6 w-10 h-10 rounded-full flex items-center justify-center opacity-0 pointer-events-none transform hover:scale-110 -translate-x-20">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="white" viewBox="0 0 256 256" class="relative z-10"><path d="M168.49,199.51a12,12,0,0,1-17,17l-80-80a12,12,0,0,1,0-17l80-80a12,12,0,0,1,17,17L97,128Z"></path></svg>
            </a>

            <div class="animate-float">
                <h1 class="text-5xl md:text-7xl font-bold text-white text-glow mb-4">
                    Norelen
                </h1>
            </div>

            <p id="intro-paragraph" class="text-lg md:text-xl text-gray-300 max-w-2xl mx-auto mt-6 mb-10">
                Un espacio creado solo para ti. Exclusivamente para ti. Espero que te guste ;)
            </p>

            <div id="button-container" class="flex flex-col sm:flex-row items-center justify-center gap-4">
                <a href="#" id="gallery-button" class="action-button w-full sm:w-auto bg-pink-500/80 hover:bg-pink-500 text-white font-semibold py-3 px-8 rounded-full shadow-lg shadow-pink-500/30 hover:shadow-pink-500/50 transform hover:scale-105">
                    Tu Galer√≠a
                </a>
                <a href="#" id="writings-button" class="action-button w-full sm:w-auto bg-cyan-500/80 hover:bg-cyan-500 text-white font-semibold py-3 px-8 rounded-full shadow-lg shadow-cyan-500/30 hover:shadow-cyan-500/50 transform hover:scale-105">
                    Escritos
                </a>
                <a href="#" id="phrase-button" class="action-button w-full sm:w-auto bg-purple-500/80 hover:bg-purple-500 text-white font-semibold py-3 px-8 rounded-full shadow-lg shadow-purple-500/30 hover:shadow-purple-500/50 transform hover:scale-105">
                    &lt;3
                </a>
                <a href="#" id="lock-button" class="action-button w-full sm:w-auto bg-gray-600/80 hover:bg-gray-500 text-white font-semibold p-3 rounded-full shadow-lg shadow-gray-500/30 hover:shadow-gray-500/50 transform hover:scale-105">
                    üîê
                </a>
            </div>
            
            <p id="special-phrase" class="message text-pink-300 text-xl mt-8"></p>
            <p id="gallery-message" class="message text-cyan-300 text-lg mt-8 leading-relaxed"></p>
            
            <div id="writings-section" class="w-full text-left mt-8">
                <div id="writings-buttons" class="flex flex-col items-center gap-4 w-full">
                    <!-- Los botones de los escritos se generar√°n aqu√≠ con JS -->
                </div>
                <div id="writing-display" class="hidden opacity-0">
                    <h3 id="writing-title" class="text-2xl font-bold text-pink-300 mb-4 text-center"></h3>
                    <p id="writing-content" class="text-gray-300 leading-relaxed whitespace-pre-wrap"></p>
                </div>
            </div>

            <div id="secret-code-section" class="mt-4">
                <div class="flex items-center justify-center gap-2">
                    <div id="secret-input-wrapper" class="w-full max-w-xs mx-auto">
                        <input type="text" id="secret-code-input" placeholder="Introduce un c√≥digo" class="text-center w-full p-2 rounded-lg text-white">
                    </div>
                    <a href="#" id="submit-code-button" class="gradient-ball w-10 h-10 rounded-full flex-shrink-0 flex items-center justify-center transform hover:scale-110">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="white" viewBox="0 0 256 256"><path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm45.66,85.66-48,48a8,8,0,0,1-11.32,0l-24-24a8,8,0,0,1,11.32-11.32L112,140.69l42.34-42.35a8,8,0,0,1,11.32,11.32Z"></path></svg>
                    </a>
                </div>
            </div>

        </div>

    </main>

    <script>
        // Script para el efecto de brillo del cursor
        const cursorGlow = document.getElementById('cursor-glow');
        document.addEventListener('mousemove', (e) => {
            requestAnimationFrame(() => {
                cursorGlow.style.left = `${e.clientX}px`;
                cursorGlow.style.top = `${e.clientY}px`;
            });
        });

        // Script para el efecto de part√≠culas y constelaciones
        const canvas = document.getElementById('particle-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let particlesArray;
        const mouse = { x: null, y: null };
        window.addEventListener('mousemove', (event) => {
            mouse.x = event.x;
            mouse.y = event.y;
        });
        window.addEventListener('mouseout', () => {
            mouse.x = null;
            mouse.y = null;
        });
        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.size = Math.random() * 2.5 + 1;
                this.speedX = (Math.random() * 0.6) - 0.3;
                this.speedY = (Math.random() * 0.6) - 0.3;
                this.color = 'rgba(236, 72, 153, 0.5)';
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                if (this.x < 0 || this.x > canvas.width || this.y < 0 || this.y > canvas.height) {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height;
                }
            }
            draw() {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        function init() {
            particlesArray = [];
            let numberOfParticles = (canvas.height * canvas.width) / 12000;
            for (let i = 0; i < numberOfParticles; i++) {
                particlesArray.push(new Particle());
            }
        }
        function connect() {
            let opacityValue = 1;
            for (let a = 0; a < particlesArray.length; a++) {
                for (let b = a; b < particlesArray.length; b++) {
                    let distance = ((particlesArray[a].x - particlesArray[b].x) * (particlesArray[a].x - particlesArray[b].x))
                                 + ((particlesArray[a].y - particlesArray[b].y) * (particlesArray[a].y - particlesArray[b].y));
                    
                    if (distance < (canvas.width/7) * (canvas.height/7)) {
                        opacityValue = 1 - (distance/20000);
                        ctx.strokeStyle = `rgba(107, 213, 255, ${opacityValue})`;
                        ctx.lineWidth = 1;
                        ctx.beginPath();
                        ctx.moveTo(particlesArray[a].x, particlesArray[a].y);
                        ctx.lineTo(particlesArray[b].x, particlesArray[b].y);
                        ctx.stroke();
                    }
                }
            }
        }
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let i = 0; i < particlesArray.length; i++) {
                particlesArray[i].update();
                particlesArray[i].draw();
            }
            connect();
            requestAnimationFrame(animate);
        }
        init();
        animate();
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            init();
        });

        // --- L√ìGICA DE LA INTERFAZ ---

        // Elementos del DOM
        const glowingCard = document.getElementById('glowing-card');
        const phraseButton = document.getElementById('phrase-button');
        const galleryButton = document.getElementById('gallery-button');
        const writingsButton = document.getElementById('writings-button');
        const lockButton = document.getElementById('lock-button');
        const backButton = document.getElementById('back-button');
        const phraseElement = document.getElementById('special-phrase');
        const galleryMessage = document.getElementById('gallery-message');
        const secretCodeSection = document.getElementById('secret-code-section');
        const secretInputWrapper = document.getElementById('secret-input-wrapper');
        const secretCodeInput = document.getElementById('secret-code-input');
        const submitCodeButton = document.getElementById('submit-code-button');
        const buttonContainer = document.getElementById('button-container');
        const introParagraph = document.getElementById('intro-paragraph');
        const writingsSection = document.getElementById('writings-section');
        const writingsButtons = document.getElementById('writings-buttons');
        const writingDisplay = document.getElementById('writing-display');
        const writingTitle = document.getElementById('writing-title');
        const writingContent = document.getElementById('writing-content');

        // Contenido
        const phrases = [
            "Eres demasiado bonita, no dejes que nadie te haga creer lo contrario.",
            "No importa lo que pase, siempre ser√°s especial para alguien.",
            "Tu luz ilumina los rincones m√°s oscuros del mundo.",
            "Eres un sue√±o del que nadie querr√≠a despertar.",
            "Tu existencia es la poes√≠a m√°s bonita jam√°s escrita. Significa esperanza.",
            "No importa cu√°ntas veces te lo diga, siempre ser√° poco: eres incre√≠ble.",
            "Cada parte de ti es bella, desde tus sue√±os hasta tus imperfecciones.",
            "Eres la raz√≥n por la que creo que existen buenas mujeres.",
            "Necesito que lo recuerdes: ERES ESPECIAAAAAAAAAAAL.",
            "99.9% de probabilidad de que alguien te ame. Y ese alguien soy yo.",
            "Eres la definici√≥n de belleza, tanto por dentro como por fuera.",
            "Formas parte de mis pensamientos m√°s felices.",
            "Si me preguntaras cu√°ntas veces he pensado en ti, diri√≠a que solo una vaz, porque entraste y nunca saliste.",
            "Bonita es la palabra que se queda corta para describirte.",
            "Si la belleza fuera tiempo, t√∫ ser√≠as eternidad.",
            "Sisisi, eres pro, lo acepto."


        ];

        // --- INICIO CAMBIOS ---
        const writingsData = {
            'carta-1': {
                title: "Para la chica de mis sue√±os",
                content: `T√∫, Amy Norelen, apareciste como un farol en medio de una noche oscura y fr√≠a, una luz de esperanza que me record√≥ que no todo est√° perdido. \n\Pero tengo miedo, amar duele. Es por eso que solo los m√°s valientes se atreven a amar. Y yo quiero ser valiente. En este poco tiempo me has parecido fascinante, y deseo seguir conoci√©ndote m√°s y m√°s. No soy un lud√≥pata, pero quiero apostar esta vez, apostar a que el amor existe y apostarlo contigo. Esta decisi√≥n no fue f√°cil, pero creo que debo dejar de tener tanto miedo. Ahora dime t√∫: ¬øVas a apostar conmigo tambi√©n?`,
                locked: true,
                code: 'apuesta'
            },

            'carta-2': {
                title: "Sinceridad",
                content: `Oye‚Ä¶ no s√© c√≥mo empezar esto, ni siquiera s√© si lo estoy escribiendo bien. Tal vez estoy diciendo demasiado o tal vez me quede corto, pero igual quiero intentarlo. Porque si no lo digo, me lo guardo, y guardarse lo que uno siente a veces pesa m√°s que cualquier cosa.\n\nLa verdad es que tengo miedo. Miedo de equivocarme, de no ser suficiente, de que esto que siento se quede en el aire y no llegue a ti como lo imagino en mi cabeza. A veces pienso que amar duele demasiado, y que lo f√°cil ser√≠a no arriesgarse. Pero entonces apareces t√∫, y me rompes todas esas excusas que yo mismo me invento.\n\nNo s√© exactamente qu√© tienes‚Ä¶ si es tu forma de hablar, de re√≠r, de verme como si de verdad me notaras en un mundo que siempre pasa de largo. Lo que s√≠ s√© es que me haces querer quedarme, aunque tenga miedo, aunque duela, aunque no tenga la certeza de nada.\n\nQuiero ser honesto contigo: no soy perfecto, ni s√© jugar a serlo. Me equivoco demasiado, digo cosas raras, y a veces hasta me cierro cuando m√°s deber√≠a abrirme. Pero aqu√≠ estoy, intentando escribirte algo que salga directo de m√≠, sin adornos de m√°s, solo lo que me sale al pensarte.\n\nMe haces creer que el amor todav√≠a existe, que no es solo una idea bonita que siempre termina rompi√©ndose. Y por eso quiero apostar esta vez, contigo. No porque sea f√°cil, no porque est√© seguro del resultado, sino porque creo que vales cada riesgo, cada duda, cada pedazo de miedo que tenga que tragarme para dar un paso hacia ti.\n\nNo espero que lo entiendas todo, ni que me respondas como en las pel√≠culas, con frases perfectas. Solo quiero que sepas que lo que siento es real, aunque venga con nervios, con imperfecciones y con silencios inc√≥modos hahaha.\n\nAs√≠ que aqu√≠ estoy: abierto, siendo sincero.`,
                locked: false,
                code: 'sincero'
            }
        };
        // --- FIN CAMBIOS ---

        // Variables de estado
        let currentPhraseIndex = -1;
        let animationState = 'initial'; // 'initial', 'phrases', 'gallery', 'secret', 'writings'

        // Funciones de la interfaz
        function showMessage(element, text) {
            document.querySelectorAll('.message').forEach(msg => msg.classList.remove('is-visible'));
            writingsSection.classList.remove('is-visible');
            setTimeout(() => {
                if(text) element.innerHTML = text;
                element.classList.add('is-visible');
            }, 300);
        }

        function shrinkCard() {
            if (animationState === 'initial') {
                glowingCard.classList.add('is-shrunken');
                introParagraph.style.maxHeight = '0';
                introParagraph.style.marginTop = '0';
                introParagraph.style.marginBottom = '0';
                introParagraph.classList.add('opacity-0');
                backButton.classList.remove('opacity-0', 'pointer-events-none', '-translate-x-20');
            }
        }

        function handleSectionClick(state, element, text) {
            if (animationState !== 'initial') return;
            
            shrinkCard();
            animationState = state;
            
            buttonContainer.style.maxHeight = '0';
            buttonContainer.style.opacity = '0';
            buttonContainer.classList.add('pointer-events-none');

            if (element) {
                if(text) element.innerHTML = text;
                element.classList.add('is-visible');
            }
        }

        // Event Listeners para los botones principales
        phraseButton.addEventListener('click', (e) => {
    e.preventDefault();

    // Si la secci√≥n <3 no est√° activa, haz la animaci√≥n solo una vez
    if (animationState !== 'phrases') {
        shrinkCard();
        animationState = 'phrases';
        ['gallery-button', 'writings-button', 'lock-button'].forEach(id => {
            const btn = document.getElementById(id);
            btn.style.width = '0';
            btn.style.paddingLeft = '0';
            btn.style.paddingRight = '0';
            btn.style.margin = '0';
            btn.style.opacity = '0';
        });
        buttonContainer.style.justifyContent = 'center';
    }

    // Siempre muestra una frase diferente
    let randomIndex;
    do {
        randomIndex = Math.floor(Math.random() * phrases.length);
    } while (phrases.length > 1 && randomIndex === currentPhraseIndex);
    currentPhraseIndex = randomIndex;
    showMessage(phraseElement, phrases[currentPhraseIndex]);
    });
    phraseButton.addEventListener('click', (e) => {
    e.preventDefault();

    // Si la secci√≥n <3 no est√° activa, haz la animaci√≥n solo una vez
    if (animationState !== 'phrases') {
        shrinkCard();
        animationState = 'phrases';
        ['gallery-button', 'writings-button', 'lock-button'].forEach(id => {
            const btn = document.getElementById(id);
            btn.style.width = '0';
            btn.style.paddingLeft = '0';
            btn.style.paddingRight = '0';
            btn.style.margin = '0';
            btn.style.opacity = '0';
        });
        buttonContainer.style.justifyContent = 'center';
    }

    // Siempre muestra una frase diferente
    let randomIndex;
    do {
        randomIndex = Math.floor(Math.random() * phrases.length);
    } while (phrases.length > 1 && randomIndex === currentPhraseIndex);
    currentPhraseIndex = randomIndex;
    showMessage(phraseElement, phrases[currentPhraseIndex]);
});

        
        galleryButton.addEventListener('click', (e) => {
            e.preventDefault();
            const text = "Uyyy, lo siento. No puedo poner fotos tuyas si no las tengo.üòâ<br>PD: Conforme pase el tiempo ir√© agregando nuevas cosas ;)";
            handleSectionClick('gallery', galleryMessage, text);
        });
        
        lockButton.addEventListener('click', (e) => {
            e.preventDefault();
            handleSectionClick('secret');
            secretCodeSection.classList.add('is-visible');
        });

        writingsButton.addEventListener('click', (e) => {
            e.preventDefault();
            handleSectionClick('writings', writingsSection);

            writingsButtons.innerHTML = '';
            let unlockedCount = 0;
            for (const key in writingsData) {
                if (!writingsData[key].locked) { // Solo mostrar si no est√° bloqueado
                    unlockedCount++;
                    const button = document.createElement('a');
                    button.href = '#';
                    button.textContent = writingsData[key].title;
                    button.dataset.key = key;
                    button.className = 'w-full max-w-sm bg-purple-500/80 hover:bg-purple-500 text-white font-semibold py-3 px-6 rounded-full shadow-lg shadow-purple-500/30 hover:shadow-purple-500/50 transform hover:scale-105 transition-all duration-300';
                    writingsButtons.appendChild(button);
                }
            }

            if (unlockedCount === 0) {
                const p = document.createElement('p');
                p.textContent = 'A√∫n no has desbloqueado ning√∫n escrito. ¬°Usa los c√≥digos secretos!';
                p.className = 'text-center text-gray-400';
                writingsButtons.appendChild(p);
            }

            writingDisplay.classList.add('hidden');
            writingDisplay.classList.remove('opacity-0');
            writingsButtons.classList.remove('hidden');
        });

        writingsButtons.addEventListener('click', (e) => {
            e.preventDefault();
            if (e.target.tagName === 'A') {
                const key = e.target.dataset.key;
                const writing = writingsData[key];

                if (writing) {
                    writingTitle.textContent = writing.title;
                    writingContent.textContent = writing.content;

                    writingsButtons.classList.add('hidden');
                    writingDisplay.classList.remove('hidden');
                    setTimeout(() => writingDisplay.classList.add('opacity-100'), 50);
                }
            }
        });

        secretCodeInput.addEventListener('focus', () => {
            if (!secretInputWrapper.classList.contains('success')) {
                secretInputWrapper.classList.add('is-focused');
            }
        });
        secretCodeInput.addEventListener('blur', () => {
            secretInputWrapper.classList.remove('is-focused');
        });

        // --- INICIO CAMBIOS ---
        submitCodeButton.addEventListener('click', (e) => {
            e.preventDefault();
            secretInputWrapper.classList.remove('error', 'success', 'is-focused');
            const enteredCode = secretCodeInput.value.toLowerCase();
            let codeFound = false;

            for (const key in writingsData) {
                if (writingsData[key].code === enteredCode) {
                    writingsData[key].locked = false; // Desbloquear el escrito
                    codeFound = true;
                    break; // Salir del bucle una vez encontrado
                }
            }

            if (codeFound) {
                secretInputWrapper.classList.add('success');
                setTimeout(() => {
                    backButton.click();
                }, 500);
            } else {
                secretInputWrapper.classList.add('error');
                setTimeout(() => {
                    secretInputWrapper.classList.remove('error');
                }, 820);
            }
        });
        // --- FIN CAMBIOS ---

        backButton.addEventListener('click', (e) => {
            e.preventDefault();
            if (animationState === 'initial') return;

            if (animationState === 'writings' && !writingDisplay.classList.contains('hidden')) {
                writingDisplay.classList.remove('opacity-100');
                setTimeout(() => {
                    writingDisplay.classList.add('hidden');
                    writingsButtons.classList.remove('hidden');
                }, 400);
                return; 
            }

            glowingCard.classList.remove('is-shrunken');
            backButton.classList.add('opacity-0', 'pointer-events-none', '-translate-x-20');
            document.querySelectorAll('.message').forEach(msg => msg.classList.remove('is-visible'));
            secretCodeSection.classList.remove('is-visible');
            writingsSection.classList.remove('is-visible');
            secretCodeInput.value = '';
            secretInputWrapper.classList.remove('error', 'success', 'is-focused');

            introParagraph.style.maxHeight = '';
            introParagraph.style.marginTop = '';
            introParagraph.style.marginBottom = '';
            introParagraph.classList.remove('opacity-0');

            buttonContainer.style.maxHeight = '';
            buttonContainer.style.opacity = '';
            buttonContainer.classList.remove('pointer-events-none');
            buttonContainer.style.justifyContent = '';

            document.querySelectorAll('.action-button').forEach(btn => {
                btn.style.width = '';
                btn.style.paddingLeft = '';
                btn.style.paddingRight = '';
                btn.style.margin = '';
                btn.style.opacity = '';
            });
            
            animationState = 'initial';
        });
    </script>

</body>
</html>
